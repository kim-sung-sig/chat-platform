# ì±„íŒ… í”Œë«í¼ ë§ˆì´ê·¸ë ˆì´ì…˜ ì§„í–‰ ìƒí™©

## ğŸ“… ì‘ì—… ì¼ì: 2025-12-09

---

## âœ… ì™„ë£Œëœ ì‘ì—…

### Step 1: chat-domain ëª¨ë“ˆ ìƒì„± âœ… (ì™„ë£Œ)

#### 1.1 ëª¨ë“ˆ êµ¬ì¡° ìƒì„±
- âœ… ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±
- âœ… build.gradle ì‘ì„±
- âœ… settings.gradleì— ëª¨ë“ˆ ì¶”ê°€

#### 1.2 Message Domain ìƒì„±
- âœ… `MessageId` (Value Object)
- âœ… `MessageType` (Enum: TEXT, IMAGE, FILE, SYSTEM, VIDEO, AUDIO)
- âœ… `MessageStatus` (Enum: PENDING, SENT, DELIVERED, READ, FAILED)
- âœ… `MessageContent` (Value Object)
- âœ… `Message` (Aggregate Root)
- âœ… `MessageRepository` (Interface)

#### 1.3 Channel Domain ìƒì„±
- âœ… `ChannelId` (Value Object)
- âœ… `ChannelType` (Enum: DIRECT, GROUP, PUBLIC, PRIVATE)
- âœ… `Channel` (Aggregate Root)
- âœ… `ChannelRepository` (Interface)

#### 1.4 Schedule Domain ìƒì„±
- âœ… `ScheduleId` (Value Object)
- âœ… `ScheduleType` (Enum: ONE_TIME, RECURRING)
- âœ… `ScheduleStatus` (Enum: PENDING, ACTIVE, EXECUTED, CANCELLED, FAILED)
- âœ… `CronExpression` (Value Object)
- âœ… `ScheduleRule` (Aggregate Root)
- âœ… `ScheduleRuleRepository` (Interface)

#### 1.5 User Domain ìƒì„±
- âœ… `UserId` (Value Object)

#### 1.6 Common Domain ìƒì„±
- âœ… `Cursor` (Value Object - ì»¤ì„œ ê¸°ë°˜ í˜ì´ì§•)

#### 1.7 Domain Service ìƒì„±
- âœ… `MessageDomainService`
  - í…ìŠ¤íŠ¸, ì´ë¯¸ì§€, íŒŒì¼, ì‹œìŠ¤í…œ ë©”ì‹œì§€ ìƒì„±
  - ë©”ì‹œì§€ ë‚´ìš© ê²€ì¦
- âœ… `ChannelDomainService`
  - ì¼ëŒ€ì¼, ê·¸ë£¹, ê³µê°œ, ë¹„ê³µê°œ ì±„ë„ ìƒì„±
  - ì±„ë„ëª… ê²€ì¦
- âœ… `ScheduleDomainService`
  - ë‹¨ë°œì„±, ì£¼ê¸°ì  ìŠ¤ì¼€ì¤„ ìƒì„±
  - ìŠ¤ì¼€ì¤„ ì‹œê°„ ê²€ì¦

#### 1.8 ë¹Œë“œ í™•ì¸
- âœ… `./gradlew :chat-domain:build` ì„±ê³µ

---

## ğŸš§ ì§„í–‰ ì¤‘ì¸ ì‘ì—…

### Step 2: chat-storage ë¦¬íŒ©í† ë§ (ì§„í–‰ ì˜ˆì •)

#### 2.1 íŒ¨í‚¤ì§€ êµ¬ì¡° ì •ë¦¬
- [ ] `entity/` - JPA Entity
- [ ] `repository/` - JPA Repository
- [ ] `adapter/` - Domain Repository êµ¬í˜„
- [ ] `mapper/` - Entity â†” Domain ë³€í™˜

#### 2.2 Entity ìˆ˜ì •
- [ ] `ChatMessageEntity` - MessageStatus Enum ì ìš©
- [ ] `ChatChannelEntity` - ChannelType Enum ì ìš©
- [ ] `ScheduleRuleEntity` - ScheduleType, ScheduleStatus Enum ì ìš©

#### 2.3 Repository Adapter êµ¬í˜„
- [ ] `MessageRepositoryAdapter`
- [ ] `ChannelRepositoryAdapter`
- [ ] `ScheduleRepositoryAdapter`

#### 2.4 Mapper êµ¬í˜„
- [ ] `MessageMapper`
- [ ] `ChannelMapper`
- [ ] `ScheduleMapper`

#### 2.5 JpaConfig ìˆ˜ì •
- [ ] `@EntityScan` ì„¤ì •
- [ ] `@EnableJpaRepositories` ì„¤ì •

---

## â³ ëŒ€ê¸° ì¤‘ì¸ ì‘ì—…

### Step 3: chat-message-server ë¦¬íŒ©í† ë§
- [ ] Application íŒ¨í‚¤ì§€ ìƒì„± (Use Case)
- [ ] Use Case êµ¬í˜„ (Early Return íŒ¨í„´)
- [ ] Controller ë ˆì´ì–´ ì •ë¦¬
- [ ] Infrastructure ë ˆì´ì–´ ì •ë¦¬

### Step 4: chat-system-server ë¦¬íŒ©í† ë§
- [ ] Application íŒ¨í‚¤ì§€ ìƒì„±
- [ ] Channel Use Cases
- [ ] Message Query Use Case (Cursor ê¸°ë°˜)
- [ ] Schedule Use Cases (ë‹¨ë°œì„±, ì£¼ê¸°ì , ê°•ì œ ë°œì†¡)
- [ ] Quartz Job êµ¬í˜„ (ë™ì‹œì„± ì œì–´)

### Step 5: chat-websocket-server ë¦¬íŒ©í† ë§
- [ ] Redis ê¸°ë°˜ ì„¸ì…˜ ê´€ë¦¬
- [ ] WebSocket í•¸ë“¤ëŸ¬
- [ ] Redis Subscriber

### Step 6: ì •ë¦¬ ì‘ì—…
- [ ] .bak íŒŒì¼ ì‚­ì œ
- [ ] ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì½”ë“œ ì œê±°
- [ ] ì½”ë“œ ì»¨ë²¤ì…˜ ê²€í† 

### Step 7: í…ŒìŠ¤íŠ¸ ë° ê²€ì¦
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- [ ] í†µí•© í…ŒìŠ¤íŠ¸
- [ ] API í…ŒìŠ¤íŠ¸

---

## ğŸ“Š í•µì‹¬ ì„¤ê³„ ì›ì¹™ ì ìš© í˜„í™©

### âœ… DDD (Domain-Driven Design)
- âœ… Aggregate Root ì •ì˜ (Message, Channel, ScheduleRule)
- âœ… Value Object ì •ì˜ (Id, Content, CronExpression, Cursor)
- âœ… Domain Service êµ¬í˜„
- âœ… Repository Interface (í¬íŠ¸) ì •ì˜

### âœ… ì˜ì¡´ì„± ì—­ì „ (Dependency Inversion)
- âœ… Domain ê³„ì¸µì€ ì¸í”„ë¼ì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ
- âœ… RepositoryëŠ” Interfaceë¡œ ì •ì˜ (êµ¬í˜„ì€ Storage ê³„ì¸µ)

### âœ… ë‹¨ì¼ ì±…ì„ ì›ì¹™ (Single Responsibility)
- âœ… ê° AggregateëŠ” ëª…í™•í•œ ì±…ì„
- âœ… Domain ServiceëŠ” ì—¬ëŸ¬ Aggregate ê°„ ì¡°ìœ¨

### ğŸ”„ Early Return íŒ¨í„´ (Step 3ë¶€í„° ì ìš© ì˜ˆì •)
- [ ] Use Caseì—ì„œ ì¡°ê¸° ê²€ì¦ ë° ë°˜í™˜

### ğŸ”„ ì»¤ì„œ ê¸°ë°˜ í˜ì´ì§• (Step 2ë¶€í„° êµ¬í˜„)
- âœ… Cursor Value Object ì •ì˜
- [ ] Repositoryì—ì„œ êµ¬í˜„

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

**Step 2: chat-storage ë¦¬íŒ©í† ë§ ì‹œì‘**

1. ê¸°ì¡´ Entity íŒŒì¼ ê²€í† 
2. Enum ì ìš©
3. Adapter íŒ¨í„´ êµ¬í˜„
4. Mapper êµ¬í˜„
5. JpaConfig ì„¤ì • ìˆ˜ì •

---

## ğŸ“ ì°¸ê³  ì‚¬í•­

### ì£¼ìš” ì˜ì‚¬ê²°ì •
1. **Domainê³¼ Storage ë¶„ë¦¬**: ìˆœìˆ˜ ë„ë©”ì¸ ë¡œì§ê³¼ ì˜ì†ì„± êµ¬í˜„ ì™„ì „ ë¶„ë¦¬
2. **ì»¤ì„œ ê¸°ë°˜ í˜ì´ì§•**: Offset ë°©ì‹ ëŒ€ì‹  ì„±ëŠ¥ì´ ì¢‹ì€ Cursor ë°©ì‹ ì±„íƒ
3. **ë™ì‹œì„± ì œì–´**: ë¹„ê´€ì  ë½ + Quartz `@DisallowConcurrentExecution`
4. **Early Return**: ê°€ë…ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ

### ê¸°ìˆ  ìŠ¤íƒ
- Java 21
- Spring Boot 3.x
- PostgreSQL
- Redis
- Quartz Scheduler
- QueryDSL

---

**ì‘ì—… ì§„í–‰ë¥ : Step 1/7 ì™„ë£Œ (ì•½ 14%)**
