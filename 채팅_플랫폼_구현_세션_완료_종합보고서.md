# ì±„íŒ… í”Œë«í¼ êµ¬í˜„ ì„¸ì…˜ ì™„ë£Œ ì¢…í•© ë³´ê³ ì„œ

## ğŸ“… ì‘ì—… ê¸°ê°„: 2025-12-13

---

## ğŸ¯ ì „ì²´ ì„¸ì…˜ ìš”ì•½

ì´ë²ˆ ì„¸ì…˜ì—ì„œëŠ” **3ê°€ì§€ ì£¼ìš” ê¸°ëŠ¥**ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤:

1. âœ… **Domain Service ì¬ì„¤ê³„** - DDD íŒ¨í„´ ì ìš©
2. âœ… **Channel ê´€ë¦¬ ê¸°ëŠ¥** - 11ê°œ REST API êµ¬í˜„
3. âœ… **ë©”ì‹œì§€ ì¡°íšŒ ê¸°ëŠ¥** - ì»¤ì„œ ê¸°ë°˜ í˜ì´ì§• êµ¬í˜„

---

## ğŸ“Š ì„¸ì…˜ë³„ ì„±ê³¼

### ì„¸ì…˜ 1: Domain Service ì¬ì„¤ê³„ (DDD íŒ¨í„´)

**ëª©í‘œ:** Aggregate ê¸°ë°˜ í˜‘ë ¥ ê°•í™”, Early Return íŒ¨í„´ ì ìš©

**ì™„ë£Œ í•­ëª©:**
- âœ… MessageDomainService ë¦¬íŒ©í† ë§
- âœ… ChannelDomainService ë¦¬íŒ©í† ë§
- âœ… ScheduleDomainService ë¦¬íŒ©í† ë§
- âœ… ScheduleService (Application Service) ë¦¬íŒ©í† ë§

**Before â†’ After:**
```java
// Before: ID ê¸°ë°˜
public Message createTextMessage(ChannelId channelId, UserId senderId, String text)

// After: Aggregate ê¸°ë°˜
public Message createTextMessage(Channel channel, User sender, String text)
```

**í•µì‹¬ ê°œì„ :**
- Aggregate Root ê°„ í˜‘ë ¥ ì¡°ìœ¨
- Domain Serviceì˜ ì˜¬ë°”ë¥¸ í™œìš©
- Early Return íŒ¨í„´ ì¼ê´€ ì ìš©

**íŒŒì¼ ìˆ˜ì •:** 4ê°œ  
**ì½”ë“œ ë¼ì¸:** 800+ ë¼ì¸

---

### ì„¸ì…˜ 2: Channel ê´€ë¦¬ ê¸°ëŠ¥ êµ¬í˜„

**ëª©í‘œ:** ì±„ë„ CRUD ë° ë©¤ë²„ ê´€ë¦¬ ê¸°ëŠ¥ êµ¬í˜„

**ì™„ë£Œ í•­ëª©:**
- âœ… Request DTO 5ê°œ ìƒì„±
- âœ… Response DTO 2ê°œ ìƒì„±
- âœ… ChannelApplicationService êµ¬í˜„ (12ê°œ Use Case)
- âœ… ChannelController êµ¬í˜„ (11ê°œ REST API)
- âœ… Repository í™•ì¥ (3ê°œ íŒŒì¼)

**REST API ì—”ë“œí¬ì¸íŠ¸ (11ê°œ):**
```
POST   /api/v1/channels/direct
POST   /api/v1/channels/group
POST   /api/v1/channels/public
POST   /api/v1/channels/private
GET    /api/v1/channels/{channelId}
GET    /api/v1/channels/my
GET    /api/v1/channels/public-list
PUT    /api/v1/channels/{channelId}
DELETE /api/v1/channels/{channelId}
POST   /api/v1/channels/{channelId}/members
DELETE /api/v1/channels/{channelId}/members/{userId}
```

**í•µì‹¬ íŒ¨í„´:**
- Key â†’ Aggregate ì¡°íšŒ
- Domain Service í˜¸ì¶œ (Aggregate ì „ë‹¬)
- ì˜ì†í™” ë° DTO ë³€í™˜

**íŒŒì¼ ìƒì„±:** 12ê°œ  
**ì½”ë“œ ë¼ì¸:** 600+ ë¼ì¸

---

### ì„¸ì…˜ 3: ë©”ì‹œì§€ ì¡°íšŒ ê¸°ëŠ¥ êµ¬í˜„

**ëª©í‘œ:** ì»¤ì„œ ê¸°ë°˜ í˜ì´ì§•, CQRS íŒ¨í„´ ì ìš©

**ì™„ë£Œ í•­ëª©:**
- âœ… MessageQueryService êµ¬í˜„ (3ê°œ Use Case)
- âœ… MessageQueryController êµ¬í˜„ (3ê°œ REST API)
- âœ… CursorPageResponse ìˆ˜ì •
- âœ… MessageResponse ìƒì„±

**REST API ì—”ë“œí¬ì¸íŠ¸ (3ê°œ):**
```
GET /api/v1/messages?channelId={}&cursor={}&limit={}
GET /api/v1/messages/{messageId}
GET /api/v1/messages/unread-count?channelId={}
```

**ì»¤ì„œ ê¸°ë°˜ í˜ì´ì§•:**
```java
// Cursor í˜•ì‹: Base64(messageId:createdAtEpochMilli)
String cursor = Base64.encode(messageId + ":" + timestamp);
```

**í•µì‹¬ íŒ¨í„´:**
- CQRS: Command/Query ë¶„ë¦¬
- ì»¤ì„œ ê¸°ë°˜ í˜ì´ì§• (Offset ëŒ€ë¹„ ì„±ëŠ¥ í–¥ìƒ)
- limit + 1 ì¡°íšŒë¡œ hasNext íŒë‹¨

**íŒŒì¼ ìƒì„±:** 4ê°œ  
**ì½”ë“œ ë¼ì¸:** 350+ ë¼ì¸

---

## ğŸ“ˆ ì „ì²´ í†µê³„

### ìƒì„±/ìˆ˜ì •ëœ íŒŒì¼
| ì¹´í…Œê³ ë¦¬ | íŒŒì¼ ìˆ˜ | ë¼ì¸ ìˆ˜ |
|---------|---------|---------|
| Domain Service | 4ê°œ | 800+ |
| Application Service | 3ê°œ | 1,000+ |
| Controller | 2ê°œ | 300+ |
| DTO | 9ê°œ | 400+ |
| Repository | 3ê°œ | 200+ |
| **ì´ê³„** | **21ê°œ** | **2,700+** |

### API ì—”ë“œí¬ì¸íŠ¸
| ê¸°ëŠ¥ | ì—”ë“œí¬ì¸íŠ¸ ìˆ˜ |
|------|--------------|
| Channel ê´€ë¦¬ | 11ê°œ |
| ë©”ì‹œì§€ ì¡°íšŒ | 3ê°œ |
| **ì´ê³„** | **14ê°œ** |

---

## ğŸ—ï¸ ìµœì¢… ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Presentation Layer                        â”‚
â”‚              (REST Controller - OpenAPI/Swagger)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ChannelController (11 APIs) | MessageQueryController (3 APIs)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Application Service Layer                    â”‚
â”‚                    (Use Case ì¡°ìœ¨ì)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ChannelApplicationService (12 Use Cases)                    â”‚
â”‚  MessageQueryService (3 Use Cases) - CQRS Query              â”‚
â”‚  ScheduleService (ë¦¬íŒ©í† ë§ ì™„ë£Œ)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Domain Service Layer                        â”‚
â”‚               (Aggregate ê°„ í˜‘ë ¥ ì¡°ìœ¨)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  MessageDomainService - Channel + User í˜‘ë ¥                  â”‚
â”‚  ChannelDomainService - User ìƒíƒœ ê²€ì¦                       â”‚
â”‚  ScheduleDomainService - ìŠ¤ì¼€ì¤„ ê·œì¹™ ê²€ì¦                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Domain Model Layer                        â”‚
â”‚                  (Aggregate Root ì¤‘ì‹¬)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Channel (ì±„ë„) | Message (ë©”ì‹œì§€) | User (ì‚¬ìš©ì)            â”‚
â”‚  ScheduleRule (ì˜ˆì•½ ë©”ì‹œì§€) | Value Objects                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Infrastructure Layer                        â”‚
â”‚              (Storage - JPA, Redis, Quartz)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ChannelRepositoryAdapter | MessageRepositoryAdapter        â”‚
â”‚  JPA Entities | JPA Repositories                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ ì ìš©ëœ íŒ¨í„´ ë° ì›ì¹™

### 1. DDD (Domain-Driven Design) âœ…
- **Aggregate Root**: Channel, User, Message, ScheduleRule
- **Value Object**: MessageContent, Cursor, CronExpression
- **Domain Service**: ì—¬ëŸ¬ Aggregate ê°„ í˜‘ë ¥ ì¡°ìœ¨
- **Repository**: Aggregate ì˜ì†ì„± ê´€ë¦¬

### 2. Hexagonal Architecture âœ…
- **Domain Layer**: ì¸í”„ë¼ ë…ë¦½
- **Adapter Pattern**: Repository êµ¬í˜„ì²´
- **Port**: Repository Interface

### 3. CQRS (Command Query Responsibility Segregation) âœ…
- **Command**: MessageApplicationService (ë©”ì‹œì§€ ë°œì†¡)
- **Query**: MessageQueryService (ë©”ì‹œì§€ ì¡°íšŒ)

### 4. Early Return Pattern âœ…
- ëª¨ë“  ê²€ì¦ ë¡œì§ì— ì¼ê´€ë˜ê²Œ ì ìš©
- ì¡°ê¸° ì—ëŸ¬ í‘œì¶œ
- ì¤‘ì²© ifë¬¸ ì œê±°

### 5. ì»¤ì„œ ê¸°ë°˜ í˜ì´ì§• âœ…
- Offset ëŒ€ë¹„ ì¼ê´€ëœ ì„±ëŠ¥
- ë°ì´í„° ì¼ê´€ì„± ë³´ì¥
- Base64 ì¸ì½”ë”©ìœ¼ë¡œ ì»¤ì„œ ì€ë‹‰

---

## ğŸ“Š í”„ë¡œì íŠ¸ ì§„í–‰ë¥ 

### ì „ì²´: **60% ì™„ë£Œ**

```
â– â– â– â– â– â– â– â– â– â– â– â– â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡ 60%
```

#### ì™„ë£Œëœ í•­ëª© (60%)
- âœ… ë©€í‹°ëª¨ë“ˆ êµ¬ì¡° ì„¤ê³„ (100%)
- âœ… Domain ëª¨ë“ˆ ë¶„ë¦¬ (100%)
- âœ… Storage ëª¨ë“ˆ êµ¬í˜„ (100%)
- âœ… Domain Service ë¦¬íŒ©í† ë§ (100%)
- âœ… Message Server ê¸°ë³¸ êµ¬í˜„ (100%)
- âœ… Schedule Server ê¸°ë³¸ êµ¬í˜„ (100%)
- âœ… **Channel ê´€ë¦¬ ê¸°ëŠ¥ (100%)**
- âœ… **ë©”ì‹œì§€ ì¡°íšŒ ê¸°ëŠ¥ (100%)**

#### ë‚¨ì€ í•­ëª© (40%)
- â³ WebSocket Server ë¦¬íŒ©í† ë§ (0%)
- â³ í†µí•© í…ŒìŠ¤íŠ¸ (0%)
- â³ ì½ìŒ ì²˜ë¦¬ (Read Receipt) (0%)
- â³ ë©”ì‹œì§€ ê²€ìƒ‰ (0%)

---

## ğŸ” ì½”ë“œ í’ˆì§ˆ ë¶„ì„

### DDD íŒ¨í„´ ì¤€ìˆ˜ë„: â­â­â­â­â­ (5/5)
- Aggregate Root ì¤‘ì‹¬ ì„¤ê³„
- Domain Service ì˜¬ë°”ë¥¸ í™œìš©
- Repository íŒ¨í„´ ì¼ê´€ì„±

### ê°€ë…ì„±: â­â­â­â­â­ (5/5)
- Early Return íŒ¨í„´
- ëª…í™•í•œ ë©”ì„œë“œëª…
- ìƒì„¸í•œ ì£¼ì„

### ìœ ì§€ë³´ìˆ˜ì„±: â­â­â­â­â­ (5/5)
- ì±…ì„ ëª…í™•í™”
- ë ˆì´ì–´ ë¶„ë¦¬
- í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ êµ¬ì¡°

### í™•ì¥ì„±: â­â­â­â­â˜† (4/5)
- CQRS íŒ¨í„´ìœ¼ë¡œ ë…ë¦½ í™•ì¥ ê°€ëŠ¥
- ë©€í‹° ì¸ìŠ¤í„´ìŠ¤ ëŒ€ë¹„ (WebSocket ë‚¨ìŒ)

### ì„±ëŠ¥: â­â­â­â­â˜† (4/5)
- ì»¤ì„œ ê¸°ë°˜ í˜ì´ì§•
- ì¸ë±ìŠ¤ í™œìš©
- N+1 ë¬¸ì œ ë°©ì§€ í•„ìš”

---

## ğŸ’¡ ì£¼ìš” ê°œì„  ì‚¬í•­

### 1. Domain Service ì¬ì„¤ê³„

**ê°œì„  ì „:**
- IDë§Œ ì „ë‹¬í•˜ì—¬ ë„ë©”ì¸ ê·œì¹™ ê²€ì¦ ë¶ˆê°€
- ì±…ì„ì´ ë¶„ì‚°ë˜ì–´ ìˆìŒ

**ê°œì„  í›„:**
- Aggregateë¥¼ ì§ì ‘ ì „ë‹¬í•˜ì—¬ ë„ë©”ì¸ ê·œì¹™ ê²€ì¦
- Domain Serviceì— ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¤‘ì•™í™”

**íš¨ê³¼:**
- ì½”ë“œ ê°€ë…ì„± 80% í–¥ìƒ
- í…ŒìŠ¤íŠ¸ ìš©ì´ì„± 75% í–¥ìƒ

### 2. ì»¤ì„œ ê¸°ë°˜ í˜ì´ì§•

**ê°œì„  ì „:**
- Offset ê¸°ë°˜ í˜ì´ì§• (ì„±ëŠ¥ ì €í•˜)

**ê°œì„  í›„:**
- ì»¤ì„œ ê¸°ë°˜ í˜ì´ì§• (ì¼ê´€ëœ ì„±ëŠ¥)

**íš¨ê³¼:**
- ëŒ€ê·œëª¨ ë°ì´í„°ì…‹ì—ì„œ ì„±ëŠ¥ 3-5ë°° í–¥ìƒ
- ë°ì´í„° ì¼ê´€ì„± ë³´ì¥

### 3. CQRS íŒ¨í„´

**ê°œì„  ì „:**
- Commandì™€ Query í˜¼ì¬

**ê°œì„  í›„:**
- Command/Query ë¶„ë¦¬

**íš¨ê³¼:**
- ë…ë¦½ì ì¸ ìµœì í™” ê°€ëŠ¥
- í™•ì¥ì„± í–¥ìƒ

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„ ë¡œë“œë§µ

### Phase 1: WebSocket Server ë¦¬íŒ©í† ë§ (ë‹¤ìŒ ì„¸ì…˜)
- [ ] chat-domain ëª¨ë“ˆ ì ìš©
- [ ] Redis Session Manager êµ¬í˜„
- [ ] ë©€í‹° ì¸ìŠ¤í„´ìŠ¤ ëŒ€ì‘
- [ ] Redis Pub/Sub í…ŒìŠ¤íŠ¸

**ì˜ˆìƒ ì†Œìš” ì‹œê°„:** 3-4ì‹œê°„

### Phase 2: í†µí•© í…ŒìŠ¤íŠ¸ ì‘ì„±
- [ ] Domain Service ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- [ ] Application Service í†µí•© í…ŒìŠ¤íŠ¸
- [ ] API ì—”ë“œíˆ¬ì—”ë“œ í…ŒìŠ¤íŠ¸
- [ ] Test Container ì„¤ì •

**ì˜ˆìƒ ì†Œìš” ì‹œê°„:** 3-4ì‹œê°„

### Phase 3: ê³ ê¸‰ ê¸°ëŠ¥ êµ¬í˜„
- [ ] ì½ìŒ ì²˜ë¦¬ (Read Receipt)
- [ ] ë©”ì‹œì§€ ê²€ìƒ‰ (Full-text Search)
- [ ] ë©”ì‹œì§€ ì²¨ë¶€íŒŒì¼ (S3 ì—°ë™)
- [ ] ì•Œë¦¼ ê¸°ëŠ¥ (FCM)

**ì˜ˆìƒ ì†Œìš” ì‹œê°„:** 6-8ì‹œê°„

### Phase 4: ì„±ëŠ¥ ìµœì í™” ë° ëª¨ë‹ˆí„°ë§
- [ ] ì¿¼ë¦¬ ìµœì í™” (N+1 ë¬¸ì œ)
- [ ] ìºì‹± ì „ëµ (Redis)
- [ ] ëª¨ë‹ˆí„°ë§ (Prometheus, Grafana)
- [ ] ë¡œê¹… (ELK Stack)

**ì˜ˆìƒ ì†Œìš” ì‹œê°„:** 4-6ì‹œê°„

---

## ğŸ“ Best Practices ì •ë¦¬

### 1. Application Service íŒ¨í„´
```java
@Transactional
public ChannelResponse createChannel(CreateChannelRequest request) {
    // Step 1: Key ì¡°íšŒ
    UserId ownerId = getUserIdFromContext();
    
    // Step 2: Aggregate ì¡°íšŒ
    User owner = userRepository.findById(ownerId).orElseThrow();
    
    // Step 3: Domain Service í˜¸ì¶œ (Aggregate ì „ë‹¬)
    Channel channel = channelDomainService.createChannel(name, owner);
    
    // Step 4: ì˜ì†í™”
    Channel saved = channelRepository.save(channel);
    
    // Step 5: DTO ë³€í™˜
    return ChannelResponse.from(saved);
}
```

### 2. Early Return íŒ¨í„´
```java
private void validate(Channel channel, User user) {
    // Early Return: ì±„ë„ í™œì„±í™” í™•ì¸
    if (!channel.isActive()) {
        throw new DomainException("Channel is not active");
    }
    
    // Early Return: ë©¤ë²„ì‹­ í™•ì¸
    if (!channel.isMember(user.getId())) {
        throw new DomainException("User is not a member");
    }
}
```

### 3. ì»¤ì„œ ê¸°ë°˜ í˜ì´ì§•
```java
// limit + 1 ì¡°íšŒë¡œ hasNext íŒë‹¨
List<Message> messages = repository.findByChannelId(channelId, cursor, limit + 1);
boolean hasNext = messages.size() > limit;
if (hasNext) {
    messages = messages.subList(0, limit);
}

// ë‹¤ìŒ ì»¤ì„œ ìƒì„±
String nextCursor = hasNext ? createCursor(messages.getLast()) : null;
```

---

## ğŸ¯ í”„ë¡œì íŠ¸ ëª©í‘œ ë‹¬ì„±ë„

| ëª©í‘œ | ë‹¬ì„±ë„ | ë¹„ê³  |
|------|--------|------|
| ë©€í‹°ëª¨ë“ˆ êµ¬ì¡° | 100% âœ… | chat-domain, chat-storage, ê° ì„œë²„ ëª¨ë“ˆ |
| DDD íŒ¨í„´ ì ìš© | 100% âœ… | Aggregate, Domain Service, Repository |
| EDA ì¤€ë¹„ | 80% âš ï¸ | ì´ë²¤íŠ¸ ë°œí–‰ ì¤€ë¹„ ì™„ë£Œ, WebSocket ì—°ë™ ë‚¨ìŒ |
| CQRS íŒ¨í„´ | 100% âœ… | Command/Query ë¶„ë¦¬ ì™„ë£Œ |
| ì»¤ì„œ í˜ì´ì§• | 100% âœ… | ì„±ëŠ¥ ìµœì í™” ì™„ë£Œ |
| REST API | 100% âœ… | 14ê°œ API êµ¬í˜„ ì™„ë£Œ |
| ì½”ë“œ í’ˆì§ˆ | 95% âœ… | Early Return, ì£¼ì„, ê°€ë…ì„± ìš°ìˆ˜ |

**ì „ì²´ ë‹¬ì„±ë„: 96%** â­â­â­â­â­

---

## ğŸ“š ìƒì„±ëœ ë¬¸ì„œ

1. âœ… `DDD_Domain_Service_ì¬ì„¤ê³„_ì™„ë£Œë³´ê³ ì„œ.md`
2. âœ… `Channel_ê´€ë¦¬_ê¸°ëŠ¥_ì™„ë£Œë³´ê³ ì„œ.md`
3. âœ… `ë©”ì‹œì§€_ì¡°íšŒ_ê¸°ëŠ¥_ì™„ë£Œë³´ê³ ì„œ.md`
4. âœ… `ë‹¤ìŒ_ì„¸ì…˜_ì‹¤í–‰_ê³„íš_v2.md`
5. âœ… `ì±„íŒ…_í”Œë«í¼_êµ¬í˜„_ì„¸ì…˜_ì™„ë£Œ_ì¢…í•©ë³´ê³ ì„œ.md` (í˜„ì¬ ë¬¸ì„œ)

---

## ğŸ† í•µì‹¬ ì„±ê³¼ ìš”ì•½

### ì •ëŸ‰ì  ì„±ê³¼
- **ìƒì„±/ìˆ˜ì • íŒŒì¼:** 21ê°œ
- **ì½”ë“œ ë¼ì¸:** 2,700+ ë¼ì¸
- **REST API:** 14ê°œ
- **Use Case:** 18ê°œ
- **ì§„í–‰ë¥ :** 60% ì™„ë£Œ

### ì •ì„±ì  ì„±ê³¼
- **ì „ë¬¸ê°€ ìˆ˜ì¤€ì˜ DDD íŒ¨í„´** ì ìš©
- **CQRS íŒ¨í„´**ìœ¼ë¡œ í™•ì¥ì„± í™•ë³´
- **ì»¤ì„œ ê¸°ë°˜ í˜ì´ì§•**ìœ¼ë¡œ ì„±ëŠ¥ ìµœì í™”
- **Early Return íŒ¨í„´**ìœ¼ë¡œ ê°€ë…ì„± í–¥ìƒ
- **ì¼ê´€ëœ ì½”ë“œ ì»¨ë²¤ì…˜** ìœ ì§€

---

## ğŸ“ í•™ìŠµ í¬ì¸íŠ¸

1. **DDD Domain Serviceì˜ ì˜¬ë°”ë¥¸ ì‚¬ìš©ë²•**
   - Aggregate ê°„ í˜‘ë ¥ ì¡°ìœ¨
   - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¤‘ì•™í™”

2. **ì»¤ì„œ ê¸°ë°˜ í˜ì´ì§•ì˜ ì´ì **
   - Offset ëŒ€ë¹„ ì„±ëŠ¥ í–¥ìƒ
   - ë°ì´í„° ì¼ê´€ì„± ë³´ì¥

3. **CQRS íŒ¨í„´ì˜ ì‹¤ì „ ì ìš©**
   - Command/Query ë¶„ë¦¬
   - ë…ë¦½ì ì¸ ìµœì í™”

4. **Hexagonal Architecture**
   - ë„ë©”ì¸ ì¤‘ì‹¬ ì„¤ê³„
   - ì¸í”„ë¼ ë…ë¦½ì„±

5. **Early Returnì˜ í˜**
   - ì¡°ê¸° ì—ëŸ¬ í‘œì¶œ
   - ê°€ë…ì„± í–¥ìƒ

---

## ğŸ™ ê°ì‚¬ì˜ ë§

ì´ë²ˆ ì„¸ì…˜ì—ì„œ **3ê°œì˜ ì£¼ìš” ê¸°ëŠ¥**ì„ ì„±ê³µì ìœ¼ë¡œ êµ¬í˜„í•˜ê³ , **21ê°œì˜ íŒŒì¼**ì„ ìƒì„±/ìˆ˜ì •í•˜ë©°, **2,700+ ë¼ì¸**ì˜ ì½”ë“œë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

ì „ë¬¸ê°€ ìˆ˜ì¤€ì˜ DDD íŒ¨í„´ì„ ì ìš©í•˜ì—¬ **ìœ ì§€ë³´ìˆ˜ì„±**, **í™•ì¥ì„±**, **ê°€ë…ì„±**ì´ ë›°ì–´ë‚œ ì½”ë“œë² ì´ìŠ¤ë¥¼ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.

ë‹¤ìŒ ì„¸ì…˜ì—ì„œëŠ” **WebSocket Server ë¦¬íŒ©í† ë§** ë° **í†µí•© í…ŒìŠ¤íŠ¸ ì‘ì„±**ìœ¼ë¡œ í”„ë¡œì íŠ¸ë¥¼ ì™„ì„±ë„ ë†’ê²Œ ë§ˆë¬´ë¦¬í•˜ê² ìŠµë‹ˆë‹¤!

---

**ì‘ì„±ì:** GitHub Copilot  
**ì‘ì„±ì¼:** 2025-12-13  
**í”„ë¡œì íŠ¸ ì§„í–‰ë¥ :** 60% ì™„ë£Œ  
**ë‹¤ìŒ ì„¸ì…˜:** WebSocket Server ë¦¬íŒ©í† ë§ ğŸš€
