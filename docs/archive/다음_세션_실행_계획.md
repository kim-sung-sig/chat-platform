# ë‹¤ìŒ ì„¸ì…˜ ì‹¤í–‰ ê³„íš

## ğŸ“‹ ì„¸ì…˜ ì •ë³´

- **ì„¸ì…˜ ë²ˆí˜¸**: Session 7
- **ëª©í‘œ**: API ë¬¸ì„œí™”, í†µí•© í…ŒìŠ¤íŠ¸, ì‹¤í–‰ ê²€ì¦
- **ì˜ˆìƒ ì†Œìš” ì‹œê°„**: 2-3ì‹œê°„

---

## ğŸ¯ ì„¸ì…˜ ëª©í‘œ

### 1. API ë¬¸ì„œ ìë™ ìƒì„± (Swagger/OpenAPI)

- Springdoc OpenAPI ì„¤ì •
- API ë¬¸ì„œ ìë™ ìƒì„±
- Swagger UI ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •

### 2. í†µí•© í…ŒìŠ¤íŠ¸ ì‘ì„±

- TestContainersë¥¼ ì‚¬ìš©í•œ í†µí•© í…ŒìŠ¤íŠ¸ í™˜ê²½ êµ¬ì¶•
- ì£¼ìš” API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸
- Redis, PostgreSQL ì»¨í…Œì´ë„ˆ í…ŒìŠ¤íŠ¸

### 3. ì„œë²„ ì‹¤í–‰ ê²€ì¦

- 3ê°œ ì„œë²„ ë™ì‹œ ì‹¤í–‰ í…ŒìŠ¤íŠ¸
- Health Check API ê²€ì¦
- ë¡œê·¸ í™•ì¸

### 4. ì˜ˆì•½ ë©”ì‹œì§€ E2E í…ŒìŠ¤íŠ¸

- ë‹¨ë°œì„± ìŠ¤ì¼€ì¤„ ë“±ë¡ â†’ ì‹¤í–‰ í™•ì¸
- ì£¼ê¸°ì  ìŠ¤ì¼€ì¤„ ë“±ë¡ â†’ ì‹¤í–‰ í™•ì¸
- Quartz ìŠ¤ì¼€ì¤„ëŸ¬ ë™ì‘ ê²€ì¦

---

## ğŸ“ ìƒì„¸ ì‹¤í–‰ ê³„íš

### Phase 1: API ë¬¸ì„œ ìë™ ìƒì„± (30ë¶„)

#### 1.1 Springdoc OpenAPI ì˜ì¡´ì„± ì¶”ê°€

```gradle
// build.gradle (ê° ì„œë²„ ëª¨ë“ˆ)
implementation 'org.springdoc:springdoc-openapi-starter-webmvc-ui:2.3.0'
```

#### 1.2 OpenAPI ì„¤ì • í´ë˜ìŠ¤ ì‘ì„±

- `chat-message-server`: MessageOpenApiConfig
- `chat-system-server`: SystemOpenApiConfig
- `chat-websocket-server`: WebSocketOpenApiConfig (í•„ìš” ì‹œ)

#### 1.3 Controller ì–´ë…¸í…Œì´ì…˜ ì¶”ê°€

- `@Tag`: API ê·¸ë£¹í•‘
- `@Operation`: ë©”ì„œë“œ ì„¤ëª…
- `@ApiResponse`: ì‘ë‹µ ì½”ë“œ ë° ë©”ì‹œì§€
- `@Parameter`: íŒŒë¼ë¯¸í„° ì„¤ëª…

#### 1.4 ê²€ì¦

- `http://localhost:{port}/swagger-ui.html` ì ‘ê·¼ í™•ì¸
- API ë¬¸ì„œ ìë™ ìƒì„± í™•ì¸

---

### Phase 2: í†µí•© í…ŒìŠ¤íŠ¸ í™˜ê²½ êµ¬ì¶• (45ë¶„)

#### 2.1 TestContainers ì˜ì¡´ì„± ì¶”ê°€

```gradle
testImplementation 'org.springframework.boot:spring-boot-starter-test'
testImplementation 'org.testcontainers:testcontainers:1.19.3'
testImplementation 'org.testcontainers:postgresql:1.19.3'
testImplementation 'org.testcontainers:junit-jupiter:1.19.3'
testImplementation 'com.redis.testcontainers:testcontainers-redis-junit-jupiter:1.4.6'
```

#### 2.2 í…ŒìŠ¤íŠ¸ ë² ì´ìŠ¤ í´ë˜ìŠ¤ ì‘ì„±

- `AbstractIntegrationTest`: ê³µí†µ í…ŒìŠ¤íŠ¸ ì„¤ì •
- PostgreSQL, Redis ì»¨í…Œì´ë„ˆ ìë™ ì‹œì‘

#### 2.3 ì£¼ìš” í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„±

**chat-message-server**

- `MessageControllerIntegrationTest`
	- POST /api/messages - ë©”ì‹œì§€ ë°œì†¡ í…ŒìŠ¤íŠ¸
	- POST /api/messages/reply - ë‹µì¥ ë©”ì‹œì§€ í…ŒìŠ¤íŠ¸
	- GET /api/messages/health - Health Check í…ŒìŠ¤íŠ¸

**chat-system-server**

- `ScheduleControllerIntegrationTest`
	- POST /api/schedules/one-time - ë‹¨ë°œì„± ìŠ¤ì¼€ì¤„ ë“±ë¡
	- POST /api/schedules/recurring - ì£¼ê¸°ì  ìŠ¤ì¼€ì¤„ ë“±ë¡
	- PUT /api/schedules/{id}/pause - ì¼ì‹œì¤‘ì§€
	- PUT /api/schedules/{id}/resume - ì¬ê°œ
	- DELETE /api/schedules/{id} - ì‚­ì œ

- `MessageControllerIntegrationTest`
	- POST /api/messages - ë©”ì‹œì§€ ìƒì„±
	- GET /api/messages/{id} - ë©”ì‹œì§€ ì¡°íšŒ
	- PUT /api/messages/{id} - ë©”ì‹œì§€ ìˆ˜ì •
	- DELETE /api/messages/{id} - ë©”ì‹œì§€ ì‚­ì œ

#### 2.4 í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```bash
.\gradlew test --tests "*IntegrationTest"
```

---

### Phase 3: ì„œë²„ ì‹¤í–‰ ê²€ì¦ (30ë¶„)

#### 3.1 Docker Compose ì‹¤í–‰

```bash
cd docker
docker-compose up -d
```

#### 3.2 ì„œë²„ë³„ ì‹¤í–‰

**chat-message-server (Port: 8081)**

```bash
.\gradlew :chat-message-server:bootRun
```

**chat-system-server (Port: 8082)**

```bash
.\gradlew :chat-system-server:bootRun
```

**chat-websocket-server (Port: 8083)**

```bash
.\gradlew :chat-websocket-server:bootRun
```

#### 3.3 Health Check ê²€ì¦

```bash
# chat-message-server
curl http://localhost:8081/api/messages/health

# chat-system-server
curl http://localhost:8082/actuator/health

# chat-websocket-server
curl http://localhost:8083/actuator/health
```

#### 3.4 ë¡œê·¸ í™•ì¸

- ê° ì„œë²„ ì‹œì‘ ë¡œê·¸ í™•ì¸
- Redis ì—°ê²° í™•ì¸
- PostgreSQL ì—°ê²° í™•ì¸
- Quartz ìŠ¤ì¼€ì¤„ëŸ¬ ì´ˆê¸°í™” í™•ì¸

---

### Phase 4: ì˜ˆì•½ ë©”ì‹œì§€ E2E í…ŒìŠ¤íŠ¸ (45ë¶„)

#### 4.1 ë‹¨ë°œì„± ìŠ¤ì¼€ì¤„ E2E í…ŒìŠ¤íŠ¸

**Step 1: ì±„ë„ ìƒì„±**

```bash
POST http://localhost:8082/api/channels
{
  "channelName": "í…ŒìŠ¤íŠ¸ ì±„ë„",
  "channelType": "BROADCAST",
  "description": "E2E í…ŒìŠ¤íŠ¸ìš© ì±„ë„"
}
```

**Step 2: ë‹¨ë°œì„± ìŠ¤ì¼€ì¤„ ë“±ë¡**

```bash
POST http://localhost:8082/api/schedules/one-time
{
  "roomId": "room-123",
  "channelId": 1,
  "messageType": "TEXT",
  "payload": {
    "text": "5ë¶„ í›„ ë°œì†¡ë  ë©”ì‹œì§€"
  },
  "executeAt": "2025-12-09T15:00:00"
}
```

**Step 3: ìŠ¤ì¼€ì¤„ í™•ì¸**

```bash
GET http://localhost:8082/api/schedules
```

**Step 4: ì‹¤í–‰ ëŒ€ê¸° ë° í™•ì¸**

- 5ë¶„ í›„ Quartz Job ì‹¤í–‰ í™•ì¸
- DBì—ì„œ ë©”ì‹œì§€ ìƒì„± í™•ì¸
- Redis Pub/Sub ì´ë²¤íŠ¸ ë°œí–‰ í™•ì¸
- WebSocketìœ¼ë¡œ ë©”ì‹œì§€ ì „íŒŒ í™•ì¸

#### 4.2 ì£¼ê¸°ì  ìŠ¤ì¼€ì¤„ E2E í…ŒìŠ¤íŠ¸

**Step 1: ì£¼ê¸°ì  ìŠ¤ì¼€ì¤„ ë“±ë¡ (ë§¤ 1ë¶„ë§ˆë‹¤)**

```bash
POST http://localhost:8082/api/schedules/recurring
{
  "roomId": "room-123",
  "channelId": 1,
  "messageType": "TEXT",
  "payload": {
    "text": "ë§¤ 1ë¶„ë§ˆë‹¤ ë°œì†¡ë˜ëŠ” ë©”ì‹œì§€"
  },
  "cronExpression": "0 * * * * ?",
  "maxExecutionCount": 5
}
```

**Step 2: ì‹¤í–‰ í™•ì¸**

- 1ë¶„ ê°„ê²©ìœ¼ë¡œ 5ë²ˆ ì‹¤í–‰ í™•ì¸
- ì‹¤í–‰ íšŸìˆ˜ ì¹´ìš´íŠ¸ í™•ì¸
- 5ë²ˆ ì‹¤í–‰ í›„ ìë™ ì™„ë£Œ(COMPLETED) í™•ì¸

**Step 3: ì¼ì‹œì¤‘ì§€ í…ŒìŠ¤íŠ¸**

```bash
PUT http://localhost:8082/api/schedules/{id}/pause
```

- Quartz Job ì¼ì‹œì¤‘ì§€ í™•ì¸
- ë©”ì‹œì§€ ë°œì†¡ ì¤‘ë‹¨ í™•ì¸

**Step 4: ì¬ê°œ í…ŒìŠ¤íŠ¸**

```bash
PUT http://localhost:8082/api/schedules/{id}/resume
```

- Quartz Job ì¬ê°œ í™•ì¸
- ë©”ì‹œì§€ ë°œì†¡ ì¬ê°œ í™•ì¸

---

### Phase 5: ì„±ëŠ¥ ë° ë™ì‹œì„± í…ŒìŠ¤íŠ¸ (30ë¶„)

#### 5.1 ë™ì‹œ ë©”ì‹œì§€ ë°œì†¡ í…ŒìŠ¤íŠ¸

- 100ê°œ ë©”ì‹œì§€ ë™ì‹œ ë°œì†¡
- ì‘ë‹µ ì‹œê°„ ì¸¡ì •
- ì—ëŸ¬ìœ¨ í™•ì¸

#### 5.2 Redis Pub/Sub ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

- ëŒ€ëŸ‰ ì´ë²¤íŠ¸ ë°œí–‰ í…ŒìŠ¤íŠ¸
- êµ¬ë…ìë³„ ë©”ì‹œì§€ ìˆ˜ì‹  í™•ì¸

#### 5.3 Quartz ìŠ¤ì¼€ì¤„ëŸ¬ ë¶€í•˜ í…ŒìŠ¤íŠ¸

- 100ê°œ ìŠ¤ì¼€ì¤„ ë™ì‹œ ë“±ë¡
- ë™ì‹œ ì‹¤í–‰ ì‹œ ë™ì‹œì„± ì œì–´ í™•ì¸

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

### API ë¬¸ì„œí™”

- [ ] Springdoc OpenAPI ì˜ì¡´ì„± ì¶”ê°€
- [ ] OpenAPI Config ì‘ì„±
- [ ] Controller ì–´ë…¸í…Œì´ì…˜ ì¶”ê°€
- [ ] Swagger UI ì ‘ê·¼ í™•ì¸

### í†µí•© í…ŒìŠ¤íŠ¸

- [ ] TestContainers ì˜ì¡´ì„± ì¶”ê°€
- [ ] AbstractIntegrationTest ì‘ì„±
- [ ] MessageController í†µí•© í…ŒìŠ¤íŠ¸
- [ ] ScheduleController í†µí•© í…ŒìŠ¤íŠ¸
- [ ] í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë° ê²€ì¦

### ì„œë²„ ì‹¤í–‰

- [ ] Docker Compose ì‹¤í–‰
- [ ] chat-message-server ì‹¤í–‰
- [ ] chat-system-server ì‹¤í–‰
- [ ] chat-websocket-server ì‹¤í–‰
- [ ] Health Check í™•ì¸

### E2E í…ŒìŠ¤íŠ¸

- [ ] ì±„ë„ ìƒì„± í…ŒìŠ¤íŠ¸
- [ ] ë‹¨ë°œì„± ìŠ¤ì¼€ì¤„ E2E
- [ ] ì£¼ê¸°ì  ìŠ¤ì¼€ì¤„ E2E
- [ ] ì¼ì‹œì¤‘ì§€/ì¬ê°œ í…ŒìŠ¤íŠ¸
- [ ] ìŠ¤ì¼€ì¤„ ì·¨ì†Œ í…ŒìŠ¤íŠ¸

### ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

- [ ] ë™ì‹œ ë©”ì‹œì§€ ë°œì†¡ í…ŒìŠ¤íŠ¸
- [ ] Redis Pub/Sub ì„±ëŠ¥ í™•ì¸
- [ ] Quartz ë¶€í•˜ í…ŒìŠ¤íŠ¸

---

## ğŸ“Š ì˜ˆìƒ ê²°ê³¼ë¬¼

1. **API ë¬¸ì„œ**
	- Swagger UIë¥¼ í†µí•œ ìë™ ìƒì„± ë¬¸ì„œ
	- ëª¨ë“  API ì—”ë“œí¬ì¸íŠ¸ ë¬¸ì„œí™”
	- ìš”ì²­/ì‘ë‹µ ìŠ¤í‚¤ë§ˆ ìë™ ìƒì„±

2. **í†µí•© í…ŒìŠ¤íŠ¸ ì½”ë“œ**
	- 50ê°œ ì´ìƒì˜ í†µí•© í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤
	- í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ 70% ì´ìƒ

3. **ì‹¤í–‰ ê°€ëŠ¥í•œ ì‹œìŠ¤í…œ**
	- 3ê°œ ì„œë²„ ë™ì‹œ ì‹¤í–‰
	- ì˜ˆì•½ ë©”ì‹œì§€ ë°œì†¡ ë™ì‘
	- Redis Pub/Sub ì´ë²¤íŠ¸ ì „íŒŒ

4. **ì„±ëŠ¥ ë³´ê³ ì„œ**
	- ì‘ë‹µ ì‹œê°„ ì¸¡ì • ê²°ê³¼
	- ë™ì‹œì„± í…ŒìŠ¤íŠ¸ ê²°ê³¼
	- ë³‘ëª© ì§€ì  ë¶„ì„

---

## ğŸš€ ë‹¤ìŒ ì„¸ì…˜ ì´í›„ ê³„íš

### Session 8: ë°°í¬ ìë™í™”

- Dockerfile ì‘ì„±
- Docker Compose ê°œì„ 
- CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶• (GitHub Actions)

### Session 9: ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…

- ELK Stack ì—°ë™
- Prometheus + Grafana
- ë¶„ì‚° ì¶”ì  (OpenTelemetry)

### Session 10: ìµœì í™” ë° ë§ˆë¬´ë¦¬

- N+1 ë¬¸ì œ í•´ê²°
- ìºì‹± ì „ëµ êµ¬í˜„
- ìµœì¢… ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

---

**ì‘ì„±ì¼**: 2025-12-09  
**ì‘ì„±ì**: GitHub Copilot  
**ë‹¤ìŒ ì„¸ì…˜ ì‹œì‘ ì‹ í˜¸**: "ë‹¤ìŒ ì„¸ì…˜ ì‹œì‘í•´ì¤˜"
